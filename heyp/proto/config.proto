syntax = "proto2";

package heyp.proto;

import "heyp/proto/heyp.proto";

message DemandPredictorConfig {
  optional string time_window_dur = 1 [default = "10s"];
  optional double usage_multiplier = 2 [default = 1.1];
  optional int64 min_demand_bps = 3 [default = 5000000];
}

message HostFlowTrackerConfig {
  optional DemandPredictorConfig demand_predictor = 1;
}

message HostFlowStateReporterConfig {
  repeated string this_host_addrs = 1;
  optional string ss_binary_name = 2 [default = "ss"];
}

message HostDaemonConfig {
  optional string inform_period_dur = 1 [default = "2s"];
  optional string cluster_agent_addr = 2;
  optional string cluster_agent_connection_timeout_dur = 3 [default = "10s"];
}

message StaticDCMapperConfig {
  optional DCMapping mapping = 1;
}

message HostAgentConfig {
  optional HostFlowTrackerConfig flow_tracker = 1;
  optional HostFlowStateReporterConfig flow_state_reporter = 2;
  optional HostDaemonConfig daemon = 3;
  optional StaticDCMapperConfig dc_mapper = 4;
}

enum ClusterAllocatorType {
  BWE = 0;
  HEYP_SIGCOMM20 = 1;
}

message ClusterAllocatorConfig {
  optional ClusterAllocatorType type = 1 [default = BWE];
  optional bool enable_burstiness = 2 [default = true];
  optional bool enable_bonus = 3 [default = true];
  optional double oversub_factor = 4 [default = 1.15];
}
